{
  "basic_aggregation": [
    {
      "query": "How many customers do we have?",
      "category": "basic_aggregation",
      "generated_sql": "SELECT COUNT(CUSTOMERID) FROM TELCO_DATA",
      "executes": true,
      "error": null,
      "time": 0.6830501556396484
    },
    {
      "query": "What is the total revenue?",
      "category": "basic_aggregation",
      "generated_sql": "SELECT SUM(TOTALCHARGES) FROM TELCO_DATA",
      "executes": true,
      "error": null,
      "time": 0.8913710117340088
    }
  ],
  "grouping": [
    {
      "query": "Show revenue by contract type",
      "category": "grouping",
      "generated_sql": "SELECT CONTRACT, SUM(TOTALCHARGES) AS REVENUE FROM TELCO_DATA GROUP BY CONTRACT",
      "executes": true,
      "error": null,
      "time": 2.114795684814453
    },
    {
      "query": "Count customers by payment method",
      "category": "grouping",
      "generated_sql": "SELECT PAYMENTMETHOD, COUNT(CUSTOMERID) FROM TELCO_DATA GROUP BY PAYMENTMETHOD",
      "executes": true,
      "error": null,
      "time": 0.8335058689117432
    }
  ],
  "filtering": [
    {
      "query": "Show customers with monthly charges over 100",
      "category": "filtering",
      "generated_sql": "SELECT * FROM TELCO_DATA WHERE MONTHLYCHARGES > 100",
      "executes": true,
      "error": null,
      "time": 0.696911096572876
    },
    {
      "query": "Show only senior citizens",
      "category": "filtering",
      "generated_sql": "SELECT * FROM TELCO_DATA WHERE SENIORCITIZEN = 1",
      "executes": true,
      "error": null,
      "time": 0.6710901260375977
    }
  ],
  "time_intelligence": [
    {
      "query": "Show month-over-month revenue growth",
      "category": "time_intelligence",
      "generated_sql": "SELECT \n    EXTRACT(MONTH FROM TO_DATE(TENURE, 'YYYY-MM')) AS month,\n    SUM(MONTHLYCHARGES) AS revenue,\n    LAG(SUM(MONTHLYCHARGES), 1, 0) OVER (ORDER BY EXTRACT(MONTH FROM TO_DATE(TENURE, 'YYYY-MM'))) AS prev_month_revenue,\n    (SUM(MONTHLYCHARGES) - LAG(SUM(MONTHLYCHARGES), 1, 0) OVER (ORDER BY EXTRACT(MONTH FROM TO_DATE(TENURE, 'YYYY-MM')))) / \n    LAG(SUM(MONTHLYCHARGES), 1, 0) OVER (ORDER BY EXTRACT(MONTH FROM TO_DATE(TENURE, 'YYYY-MM'))) AS growth\nFROM \n    TELCO_DATA\nGROUP BY \n    EXTRACT(MONTH FROM TO_DATE(TENURE, 'YYYY-MM'))\nORDER BY \n    month\n```",
      "executes": false,
      "error": "001003 (42000): SQL compilation error:\nsyntax error line 13 at position 0 unexpected '``'.",
      "time": 7.465288162231445
    },
    {
      "query": "Calculate running total of monthly charges",
      "category": "time_intelligence",
      "generated_sql": "SELECT \n  CUSTOMERID,\n  MONTHLYCHARGES,\n  SUM(MONTHLYCHARGES) OVER (ORDER BY CUSTOMERID) AS RUNNING_TOTAL\nFROM \n  TELCO_DATA\n```",
      "executes": false,
      "error": "001003 (42000): SQL compilation error:\nsyntax error line 7 at position 0 unexpected '``'.",
      "time": 2.7124764919281006
    }
  ],
  "calculated_metrics": [
    {
      "query": "Calculate the churn rate",
      "category": "calculated_metrics",
      "generated_sql": "SELECT CAST(SUM(CASE WHEN CHURN = 'Yes' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(CHURN) FROM TELCO_DATA",
      "executes": true,
      "error": null,
      "time": 2.0809717178344727
    },
    {
      "query": "What's the average revenue per user?",
      "category": "calculated_metrics",
      "error": "001003 (42000): SQL compilation error:\nsyntax error line 5 at position 27 unexpected 's'.\nsyntax err",
      "executes": false
    }
  ],
  "statistical": [
    {
      "query": "What's the correlation between tenure and monthly charges?",
      "category": "statistical",
      "error": "001003 (42000): SQL compilation error:\nsyntax error line 5 at position 27 unexpected 's'.\nsyntax err",
      "executes": false
    },
    {
      "query": "Show standard deviation of monthly charges",
      "category": "statistical",
      "generated_sql": "SELECT STDEV(MONTHLYCHARGES) FROM TELCO_DATA",
      "executes": false,
      "error": "002140 (42601): SQL compilation error:\nUnknown function STDEV",
      "time": 0.9978117942810059
    }
  ],
  "investigation": [
    {
      "query": "Why are customers churning?",
      "category": "investigation",
      "generated_sql": "SELECT GENDER, SENIORCITIZEN, PARTNER, DEPENDENTS, TENURE, PHONESERVICE, MULTIPLELINES, INTERNETSERVICE, ONLINESECURITY, ONLINEBACKUP, DEVICEPROTECTION, TECHSUPPORT, STREAMINGTV, STREAMINGMOVIES, CONTRACT, PAPERLESSBILLING, PAYMENTMETHOD, MONTHLYCHARGES, TOTALCHARGES FROM TELCO_DATA WHERE CHURN = 'Yes'",
      "executes": true,
      "error": null,
      "time": 3.354346513748169
    },
    {
      "query": "What drives customer lifetime value?",
      "category": "investigation",
      "generated_sql": "SELECT AVG(TOTALCHARGES) FROM TELCO_DATA WHERE CHURN = 'No'",
      "executes": true,
      "error": null,
      "time": 0.8745808601379395
    }
  ],
  "visualization": [
    {
      "query": "Create a bar chart of revenue by service",
      "category": "visualization",
      "generated_sql": "SELECT \n    PHONESERVICE, \n    INTERNETSERVICE, \n    ONLINESECURITY, \n    ONLINEBACKUP, \n    DEVICEPROTECTION, \n    TECHSUPPORT, \n    STREAMINGTV, \n    STREAMINGMOVIES, \n    SUM(MONTHLYCHARGES) AS REVENUE \nFROM \n    TELCO_DATA \nGROUP BY \n    PHONESERVICE, \n    INTERNETSERVICE, \n    ONLINESECURITY, \n    ONLINEBACKUP, \n    DEVICEPROTECTION, \n    TECHSUPPORT, \n    STREAMINGTV, \n    STREAMINGMOVIES",
      "executes": true,
      "error": null,
      "time": 4.5490617752075195
    },
    {
      "query": "Show a pie chart of customer distribution",
      "category": "visualization",
      "generated_sql": "SELECT GENDER, COUNT(CUSTOMERID) FROM TELCO_DATA GROUP BY GENDER",
      "executes": true,
      "error": null,
      "time": 0.7618439197540283
    }
  ]
}