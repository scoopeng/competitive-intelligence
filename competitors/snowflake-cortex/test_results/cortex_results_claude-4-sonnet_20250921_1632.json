[
  {
    "query": "Show all customers from the top 5 regions by total charges",
    "timestamp": "2025-09-21T16:31:43.984871",
    "sql_generated": true,
    "sql": "WITH top_regions AS (\n  SELECT REGION, SUM(TOTALCHARGES) as region_total\n  FROM TELCO_DATA\n  GROUP BY REGION\n  ORDER BY region_total DESC\n  LIMIT 5\n)\nSELECT t.*\nFROM TELCO_DATA t\nINNER JOIN top_regions tr ON t.REGION = tr.REGION;",
    "execution_success": false,
    "execution_result": null,
    "error": "000904 (42000): SQL compilation error: error line 2 at position 9\ninvalid identifier 'REGION'"
  },
  {
    "query": "Show month-over-month change in average monthly charges",
    "timestamp": "2025-09-21T16:31:46.348736",
    "sql_generated": true,
    "sql": "WITH monthly_avg AS (\n  SELECT \n    DATE_TRUNC('month', CURRENT_DATE - INTERVAL (TENURE) MONTH) as month,\n    AVG(MONTHLYCHARGES) as avg_monthly_charges\n  FROM TELCO_DATA\n  GROUP BY DATE_TRUNC('month', CURRENT_DATE - INTERVAL (TENURE) MONTH)\n),\nmonthly_changes AS (\n  SELECT \n    month,\n    avg_monthly_charges,\n    LAG(avg_monthly_charges) OVER (ORDER BY month) as prev_month_avg,\n    avg_monthly_charges - LAG(avg_monthly_charges) OVER (ORDER BY month) as month_over_month_change,\n    ROUND(((avg_monthly_charges - LAG(avg_monthly_charges) OVER (ORDER BY month)) / LAG(avg_monthly_charges) OVER (ORDER BY month)) * 100, 2) as pct_change\n  FROM monthly_avg\n)\nSELECT \n  month,\n  avg_monthly_charges,\n  prev_month_avg,\n  month_over_month_change,\n  pct_change\nFROM monthly_changes\nWHERE prev_month_avg IS NOT NULL\nORDER BY month;",
    "execution_success": false,
    "execution_result": null,
    "error": "001003 (42000): SQL compilation error:\nsyntax error line 3 at position 57 unexpected 'MONTH'.\nsyntax error line 6 at position 64 unexpected 'MONTH'."
  },
  {
    "query": "Calculate the standard deviation of monthly charges",
    "timestamp": "2025-09-21T16:31:54.526315",
    "sql_generated": true,
    "sql": "SELECT STDDEV(MONTHLYCHARGES) AS monthly_charges_stddev\nFROM TELCO_DATA;",
    "execution_success": true,
    "execution_result": "Returned 1 rows",
    "error": null
  },
  {
    "query": "Why are customers churning?",
    "timestamp": "2025-09-21T16:31:56.502930",
    "sql_generated": true,
    "sql": "SELECT \n    CHURN,\n    COUNT(*) as customer_count,\n    ROUND(AVG(TENURE), 2) as avg_tenure,\n    ROUND(AVG(MONTHLYCHARGES), 2) as avg_monthly_charges,\n    ROUND(AVG(TOTALCHARGES), 2) as avg_total_charges,\n    CONTRACT,\n    INTERNETSERVICE,\n    PAYMENTMETHOD,\n    COUNT(*) * 100.0 / SUM(COUNT(*)) OVER() as percentage\nFROM TELCO_DATA\nGROUP BY CHURN, CONTRACT, INTERNETSERVICE, PAYMENTMETHOD\nORDER BY CHURN DESC, customer_count DESC;",
    "execution_success": true,
    "execution_result": "Returned 9 rows",
    "error": null
  },
  {
    "query": "Show customers where total charges divided by tenure is greater than 100",
    "timestamp": "2025-09-21T16:32:00.023945",
    "sql_generated": true,
    "sql": "SELECT *\nFROM TELCO_DATA\nWHERE TOTALCHARGES / TENURE > 100;",
    "execution_success": true,
    "execution_result": "Returned 1 rows",
    "error": null
  }
]